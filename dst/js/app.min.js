"use strict";/*! Copyright Jan Wolf */
function AboutItem(){AboutItem.prototype.setDate=function(e){var i=new Date(e);t.html(i.getFullYear().toString().substring(2,4)),n.html((i.getDate()<10?"0":"")+i.getDate()),o.html((i.getMonth()<9?"0":"")+(i.getMonth()+1))},AboutItem.prototype.setLocation=function(e,t){for(;e.toString().length<8;)e+="0";for(;t.toString().length<8;)t+="0";i.html(e.toString().substring(0,8)),a.html(t.toString().substring(0,8))},AboutItem.prototype.setDescription=function(e){return s.empty(),null==e?void void 0:(void 0,void s.html(e))},AboutItem.prototype.getDescriptionOffsetFromBottom=function(){return $(window).height()-r.offset().top};var e=$(".about-item"),t=e.find(".year"),n=e.find(".day"),o=e.find(".month"),i=e.find(".lat"),a=e.find(".lng"),r=e.find(".description"),s=r.children("span")}/*! Copyright Jan Wolf */
function Map(){Map.prototype.setLocation=function(e,t){n=new google.maps.LatLng(e,t),i.setCenter(n)},Map.prototype.setBottomMaskHeight=function(e){r.filter(".bottom").height(e)},Map.prototype.animateLocationMove=function(t,o,i,a){var r=28,s=Date.now(),l=n.lat(),d=n.lng(),u=e.data("intervalObject");void 0!==u&&clearInterval(u),e.data("intervalObject",setInterval(function(){var n=(Date.now()-s)/i,r=.5>n?2*n*n:-1+(4-2*n)*n;r=Math.round(1e3*r)/1e3;var u=l+(t-l)*r,c=d+(o-d)*r;Map.prototype.setLocation(u,c),a(u,c,r),r>=1&&clearInterval(e.data("intervalObject"))},1e3/r))};var e=$(".map");if(0!=e.length){var t=[{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{visibility:"on"},{lightness:5}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"on"},{lightness:5}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#dfc0a9"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#ffeee3"}]}],n=new google.maps.LatLng(0,0),o={mapTypeControlOptions:{mapTypeIds:["Styled"]},center:n,zoom:5,scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,disableDoubleClickZoom:!0,keyboardShortcuts:!1,tilt:45,zoomControl:!1,draggable:!1,disableDefaultUI:!0,mapTypeId:"Styled"},i=new google.maps.Map(e[0],o),a=new google.maps.StyledMapType(t,{name:"Styled"});i.mapTypes.set("Styled",a);var r=$(".mask");google.maps.event.addListenerOnce(i,"bounds_changed",function(){r.appendTo(e.find(".gm-style"))}),google.maps.event.addDomListener(window,"resize",function(){i.setCenter(n)})}}/*! Copyright Jan Wolf */
function PulsarPoint(){PulsarPoint.prototype.start=function(){o=Date.now(),i=window.requestAnimationFrame(PulsarPoint.prototype.draw)},PulsarPoint.prototype.stop=function(){cancelAnimationFrame(i),PulsarPoint.prototype.clear()},PulsarPoint.prototype.clear=function(){a.clearRect(0,0,e.main,e.main),a.beginPath(),a.arc(e.main/2,e.main/2,t.dot_size/2,0,2*Math.PI,!1),a.fillStyle="rgba(0, 0, 0, 0.5)",a.fill()},PulsarPoint.prototype.draw=function(){PulsarPoint.prototype.clear();var n=Date.now(),r=(n-o)%t.duration/t.duration;a.beginPath(),a.arc(e.main/2,e.main/2,t.dot_size/2+(e.main-t.dot_size)/2*r,0,2*Math.PI,!1),a.lineWidth=t.thickness.start+r*(t.thickness.end-t.thickness.start);var s=t.alpha.start+r*(t.alpha.end-t.alpha.start);a.strokeStyle="rgba(0, 0, 0, "+s+")",a.stroke(),i=window.requestAnimationFrame(PulsarPoint.prototype.draw)};var e={main:500,main_rem:15},t={duration:1e4,dot_size:1/e.main_rem*e.main,thickness:{start:.1/e.main_rem*e.main,end:.5/e.main_rem*e.main},alpha:{start:.5,end:0}},n=$(".pulsar-point");n[0].width=e.main,n[0].height=e.main;var o,i,a=n[0].getContext("2d")}/*! Copyright Jan Wolf */
function Timeline(){Timeline.prototype.addOnChangeListener=function(e){n.push(e)},Timeline.prototype.addOnInactiveListener=function(e){o.push(e)},Timeline.prototype.cancelInactiveListening=function(){null!==a&&(clearTimeout(a),a=null)},Timeline.prototype.triggerInactiveListening=function(){0>=i||(this.cancelInactiveListening(),a=setTimeout(function(){o.forEach(function(e){e()}),void 0},i),void 0)},Timeline.prototype.setTarget=function(e){this.currentIndex=e;var t=this.items[e];r.children().removeClass("current").eq(this.currentIndex).addClass("current"),n.forEach(function(e){e(t)}),this.triggerInactiveListening()},Timeline.prototype.reset=function(){null!==a&&clearTimeout(a),this.currentIndex=void 0,void 0},Timeline.prototype.nextTarget=function(){void 0!==this.currentIndex&&this.setTarget(this.currentIndex>=this.items.length-1?0:this.currentIndex+1)},Timeline.prototype.previousTarget=function(){void 0!==this.currentIndex&&this.setTarget(0==this.currentIndex?this.items.length-1:this.currentIndex-1)},Timeline.prototype.setData=function(n){this.items=n,this.currentIndex=this.items.length>0?0:void 0;for(var o=this,i=0;i<this.items.length;i++){var a=$("<div/>",{style:"height: "+100/this.items.length+"%;","class":"target",click:function(){o.setTarget($(this).index())}}),s=new Date(this.items[i].date);a.append($("<div/>",{"class":"indicator",html:'<span class="day">'+(s.getDate()<10?"0":"")+s.getDate()+'</span><span class="month">'+(s.getMonth()<9?"0":"")+(s.getMonth()+1)+'</span><span class="year">'+s.getFullYear().toString().substring(2,4)+"</span>"})),a.hover(e,t),$(r).append(a)}};var e=function(){$(this).addClass("hovered");var e=$(this).prev().addClass("hovered-surround-0"),t=$(this).next().addClass("hovered-surround-0");e=e.prev().addClass("hovered-surround-1"),t=t.next().addClass("hovered-surround-1"),e.prev().addClass("hovered-surround-2"),t.next().addClass("hovered-surround-2")},t=function(){$(this).siblings().andSelf().removeClass("hovered hovered-surround-0 hovered-surround-1 hovered-surround-2")},n=[],o=[],i=18e4,a=null,r=$(".timeline .inner")}/*! Copyright Jan Wolf */
function VolumeToggle(){VolumeToggle.prototype.toggleMute=function(){e.prop("muted",!e.prop("muted")),$(".volume-toggle").toggleClass("fa-volume-off fa-volume-up")},VolumeToggle.prototype.mute=function(){e.prop("muted",!0),$(".volume-toggle").addClass("fa-volume-off").removeClass("fa-volume-up")},VolumeToggle.prototype.unmute=function(){e.prop("muted",!1),$(".volume-toggle").removeClass("fa-volume-off").addClass("fa-volume-up")};var e=$("audio");$(".volume-toggle").click(function(){VolumeToggle.prototype.toggleMute()})}/*! Copyright Jan Wolf */
!function(e){e(document).ready(function(){var t=new Map,n=new AboutItem,o=new Timeline,i=new PulsarPoint,a=new VolumeToggle,r=e("audio");e.getJSON("data/targets.json",function(s){if(!(s.length<=0)){o.addOnChangeListener(function(e){i.stop(),r.data("loops",0),r.off("loadstart"),r.on("loadstart",function(){void 0,r.data("ready",!1),this.currentTime=0}),r.trigger("pause"),r.attr("src","data/"+e.file),r.off("canplay"),r.on("canplay",function(){void 0,r.data("ready",!0)}),r.off("playwhenready"),r.on("playwhenready",function(){var e=function(){void 0,r.trigger("play"),i.start()};return r.data("ready")===!0?e():(void 0,void r.on("canplay",e))}),r.off("ended"),r.on("ended",function(){void 0;var o=r.data("loops");0==o&&(n.setDescription(e.description),t.setBottomMaskHeight(n.getDescriptionOffsetFromBottom())),r.data("loops",o+1),r.trigger("play")}),n.setDate(e.date),n.setDescription(null),t.setBottomMaskHeight(n.getDescriptionOffsetFromBottom()),void 0,t.animateLocationMove(e.lat,e.lng,2e3,function(e,t,o){n.setLocation(e,t),o>=1&&r.trigger("playwhenready")})}),o.setData(s);var l=function(t){var n=e(".overview").removeClass("fadeInDown fadeOutUp"),i=e(".stage").removeClass("fadeOutDown fadeInUp");t?(i.addClass("fadeOutDown"),n.show().scrollTop(0).addClass("fadeInDown"),a.mute(),o.cancelInactiveListening()):(n.addClass("fadeOutUp"),i.addClass("fadeInUp"),setTimeout(function(){if(n.hide(),i.hasClass("initial-state")){o.setTarget(0),i.removeClass("initial-state");var t=e(".close-overview"),r=t.attr("data-click-text");void 0!==r&&t.html(r)}else o.triggerInactiveListening();a.unmute()},1e3))};o.addOnInactiveListener(function(){var n=e(".close-overview"),i=n.attr("data-initial-text");void 0!==i&&n.html(i),l(!0),o.reset(),r.trigger("pause"),a.unmute(),t.setLocation(s[0].lat,s[0].lng),e(".stage").addClass("initial-state")}),e(document).keyup(function(e){switch(e.keyCode?e.keyCode:e.which){case 37:case 38:o.previousTarget();break;case 39:case 40:o.nextTarget()}}),e(".close-overview").click(function(){l(!1)}),e(".open-overview").click(function(){l(!0)}),t.setLocation(s[0].lat,s[0].lng)}}),e(window).resize(function(){t.setBottomMaskHeight(n.getDescriptionOffsetFromBottom())})})}(jQuery);